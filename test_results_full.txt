warning: `VIRTUAL_ENV=venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
============================= test session starts ==============================
platform darwin -- Python 3.12.10, pytest-8.4.1, pluggy-1.6.0
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /Users/husam/workspace/tools/shard-markdown
configfile: pyproject.toml
testpaths: tests
plugins: anyio-4.9.0, asyncio-1.1.0, cov-6.2.1, mock-3.14.1, benchmark-5.1.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 310 items

tests/e2e/test_cli_workflows.py Process output: Processing 1 markdown files...
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.01s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Query output: Error: Collection 'e2e-test-collection' not found

.Batch process output: Processing 3 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 3                │
│ Successful       │ 3                │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 3                │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.00s            │
│ Processing Speed │ 916.3 files/s    │
│ Chunks Inserted  │ 3                │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 14364.1 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 3 files and stored 3 chunks
  Inserting 3 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Recursive process output: Processing 3 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 3                │
│ Successful       │ 3                │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 3                │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.00s            │
│ Processing Speed │ 1977.5 files/s   │
│ Chunks Inserted  │ 3                │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 18531.5 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 3 files and stored 3 chunks
  Inserting 3 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Collections list output:     ChromaDB
  Collections
┏━━━━━━┳━━━━━━━┓
┃ Name ┃ Count ┃
┡━━━━━━╇━━━━━━━┩
└──────┴───────┘
No collections found

Collection create output: ✓ Created collection 'workflow-test-collection'
Description: Test collection for workflow testing

Collection info output: Error: Collection 'workflow-test-collection' does not exist

Collection delete output: Error: Collection 'workflow-test-collection' does not exist

.Config init output: ✓ Initialized configuration file:
/Users/husam/workspace/tools/shard-markdown/.shard-md/config.yaml
You can now edit the file or use 'shard-md config set' to modify values.

Config show output: chromadb:
  auth_token: null
  host: 127.0.0.1
  port: 8000
  ssl: false
  timeout: 30
chunking:
  default_overlap: 200
  default_size: 1000
  max_tokens: null
  method: !!python/object/apply:shard_markdown.config.settings.ChunkingMethod
  - fixed
  respect_boundaries: true
custom_metadata: {}
logging:
  backup_count: 5
  file_path: null
  format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
  level: INFO
  max_file_size: 10485760
plugins: []
processing:
  batch_size: 10
  include_frontmatter: true
  include_path_metadata: true
  max_workers: 4
  pattern: '*.md'
  recursive: false


..Chunking structure output: Processing 1 markdown files...
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Chunking fixed output: Processing 1 markdown files...
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Chunking structure output: Processing 1 markdown files...
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Metadata processing output: Processing 1 markdown files...
           Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ Metric          ┃ Value              ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│ File            │ frontmatter_doc.md │
│ Chunks Created  │ 1                  │
│ Processing Time │ 0.00s              │
│ Chunks Inserted │ 1                  │
│ Insertion Time  │ 0.00s              │
└─────────────────┴────────────────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Error recovery output: Processing 2 markdown files...
[13:11:34] ERROR    Failed to process
                    /private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmp
                    dxk1zfo2/invalid.md: Generated chunks exceed size limits at
                    positions: [1]
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value           ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 2               │
│ Successful       │ 1               │
│ Failed           │ 1               │
│ Success Rate     │ 50.0%           │
│ Total Chunks     │ 1               │
│ Avg Chunks/File  │ 1.0             │
│ Processing Time  │ 0.11s           │
│ Processing Speed │ 18.3 files/s    │
│ Chunks Inserted  │ 1               │
│ Insertion Time   │ 0.00s           │
│ Insertion Rate   │ 5915.8 chunks/s │
└──────────────────┴─────────────────┘
✓ Successfully processed 1 files and stored 1 chunks
  Inserting 1 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Workers 1: 0.01s
Concurrent 1 output: Processing 3 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 3                │
│ Successful       │ 3                │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 3                │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.00s            │
│ Processing Speed │ 2413.3 files/s   │
│ Chunks Inserted  │ 3                │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 17747.4 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 3 files and stored 3 chunks
  Inserting 3 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Workers 2: 0.01s
Concurrent 2 output: Processing 3 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 3                │
│ Successful       │ 3                │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 3                │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.00s            │
│ Processing Speed │ 2496.1 files/s   │
│ Chunks Inserted  │ 3                │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 18504.3 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 3 files and stored 3 chunks
  Inserting 3 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Workers 4: 0.01s
Concurrent 4 output: Processing 3 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 3                │
│ Successful       │ 3                │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 3                │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.00s            │
│ Processing Speed │ 2059.1 files/s   │
│ Chunks Inserted  │ 3                │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 20132.7 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 3 files and stored 3 chunks
  Inserting 3 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Large document output: Processing 1 markdown files...
          Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Metric          ┃ Value             ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ File            │ large_document.md │
│ Chunks Created  │ 100               │
│ Processing Time │ 0.02s             │
│ Chunks Inserted │ 100               │
│ Insertion Time  │ 0.02s             │
└─────────────────┴───────────────────┘
✓ Successfully processed and stored 100 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

..Config override output: Processing 1 markdown files...
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Quiet mode output: Processing 1 markdown files...
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Verbose mode output: Processing 1 markdown files...
[13:11:34] INFO     Using mock ChromaDB client for development/testing
           INFO     Mock ChromaDB client connected successfully
           INFO     Created mock collection: verbose-test
           INFO     Processing document:
                    /private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmp
                    oza19eu6/sample.md
           INFO     Created 1 chunks using structure-aware method
           INFO     Successfully chunked document into 1 chunks
           INFO     Successfully processed
                    /private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmp
                    oza19eu6/sample.md: 1 chunks in 0.00s
           INFO     Created 1 chunks using structure-aware method
           INFO     Successfully chunked document into 1 chunks
           INFO     Mock bulk insert: 1 chunks in 0.00s
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Very verbose mode output: Processing 1 markdown files...
[13:11:34] INFO     Using mock ChromaDB client for development/testing
           INFO     Mock ChromaDB client connected successfully
           DEBUG    Saved mock collections to storage
           INFO     Created mock collection: very-verbose-test
           INFO     Processing document:
                    /private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmp
                    oza19eu6/sample.md
           INFO     Created 1 chunks using structure-aware method
           DEBUG    Validated 1 chunks successfully
           INFO     Successfully chunked document into 1 chunks
           INFO     Successfully processed
                    /private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmp
                    oza19eu6/sample.md: 1 chunks in 0.00s
           INFO     Created 1 chunks using structure-aware method
           DEBUG    Validated 1 chunks successfully
           INFO     Successfully chunked document into 1 chunks
           DEBUG    Saved mock collections to storage
           INFO     Mock bulk insert: 1 chunks in 0.00s
      Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┓
┃ Metric          ┃ Value     ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━┩
│ File            │ sample.md │
│ Chunks Created  │ 1         │
│ Processing Time │ 0.00s     │
│ Chunks Inserted │ 1         │
│ Insertion Time  │ 0.00s     │
└─────────────────┴───────────┘
✓ Successfully processed and stored 1 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Dry run output:           Dry Run Preview
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃ Setting          ┃ Value        ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ Collection       │ dry-run-test │
│ Chunk Size       │ 1000         │
│ Chunk Overlap    │ 200          │
│ Files to Process │ 3            │
└──────────────────┴──────────────┘
Files to be processed:
   1.
/private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpz38e7eui/simple.md
   2.
/private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpz38e7eui/technical.m
d
   3.
/private/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpz38e7eui/blog.md

.Pattern filtering output: Processing 2 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 2                │
│ Successful       │ 2                │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 2                │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.00s            │
│ Processing Speed │ 2000.0 files/s   │
│ Chunks Inserted  │ 2                │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 17260.5 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 2 files and stored 2 chunks
  Inserting 2 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.Invalid name '' output: Error: Collection name cannot be empty
Aborted!

Invalid name 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' output: Error: Collection name too long:
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa (max 63 characters)
Aborted!

Invalid name 'invalid/name' output: Error: Collection name contains invalid characters: ['/']
Aborted!

Invalid name '123-numbers-first' output: Processing 1 markdown files...
Unexpected error: Collection '123-numbers-first' does not exist
Aborted!

.Missing files output: Usage: cli process [OPTIONS] INPUT_PATHS...
Try 'cli process --help' for help.

Error: Invalid value for 'INPUT_PATHS...': Path 'nonexistent1.md' does not exist.

.Permission denied output: Usage: cli process [OPTIONS] INPUT_PATHS...
Try 'cli process --help' for help.

Error: Invalid value for 'INPUT_PATHS...': Path '/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmp9xi146pd/restricted' is not readable.

.Bad config output: Error initializing shard-md: Invalid YAML in configuration file
/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpvyqnv4xl/bad_config.yaml:
mapping values are not allowed here
  in
"/var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpvyqnv4xl/bad_config.yaml",
line 2, column 14

.Performance test output: Processing 50 markdown files...
       Batch Processing Results
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Metric           ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Total Files      │ 50               │
│ Successful       │ 50               │
│ Failed           │ 0                │
│ Success Rate     │ 100.0%           │
│ Total Chunks     │ 50               │
│ Avg Chunks/File  │ 1.0              │
│ Processing Time  │ 0.02s            │
│ Processing Speed │ 3088.0 files/s   │
│ Chunks Inserted  │ 50               │
│ Insertion Time   │ 0.00s            │
│ Insertion Rate   │ 26539.5 chunks/s │
└──────────────────┴──────────────────┘
✓ Successfully processed 50 files and stored 50 chunks
  Inserting 50 chunks... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

Processing time: 0.03 seconds
.Large document output: Processing 1 markdown files...
          Processing Results
┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Metric          ┃ Value             ┃
┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ File            │ large_document.md │
│ Chunks Created  │ 999               │
│ Processing Time │ 0.16s             │
│ Chunks Inserted │ 999               │
│ Insertion Time  │ 1.69s             │
└─────────────────┴───────────────────┘
✓ Successfully processed and stored 999 chunks
  Processing document... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% (1/1) 0:00:00

.
tests/integration/test_document_processing.py ..........[13:11:36] WARNING  Permission denied reading file:
                    /var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpkxd80s6j
                    /restricted.md
           ERROR    Failed to process
                    /var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpkxd80s6j
                    /restricted.md: Permission denied reading file:
                    /var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpkxd80s6j
                    /restricted.md
..s           WARNING  File not found: does_not_exist.md
           ERROR    Failed to process does_not_exist.md: File not found:
                    does_not_exist.md
.           ERROR    Failed to process
                    /var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpcdbpbtxc
                    : Path is a directory, not a file:
                    /var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmpcdbpbtxc
.....
tests/performance/test_benchmarks.py
Single Document Benchmark Results:
Average processing time: 0.005s ± 0.000s
Average chunks created: 3.0
Processing rate: 618.9 chunks/second
Document size: 21447 characters
.
Batch Processing Benchmark Results:
Workers: 1
  Processing time: 0.018s
  Successful files: 10/10
  Total chunks: 10
  Throughput: 549.7 files/second
Workers: 2
  Processing time: 0.018s
  Successful files: 10/10
  Total chunks: 10
  Throughput: 562.4 files/second
Workers: 4
  Processing time: 0.018s
  Successful files: 10/10
  Total chunks: 10
  Throughput: 554.2 files/second
.           ERROR    Failed to process
                    /var/folders/07/p__xlp357ps_8_fb3yhffmrh0000gn/T/tmprazn80fs
                    /chunk_size_test_500.md: Generated chunks exceed size limits
                    at positions: [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23,
                    25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53,
                    55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83,
                    85, 87, 89, 91, 93, 95, 97, 99]

Chunk Size 500 (overlap 100) Results:
  Processing time: 0.011s
  Chunks created: 0
  Processing failed: Generated chunks exceed size limits at positions: [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99]
s
Chunk Size 1000 (overlap 200) Results:
  Processing time: 0.011s
  Chunks created: 89
  Avg chunk processing time: 0.1ms
  Characters per chunk: 486
.
Chunk Size 1500 (overlap 300) Results:
  Processing time: 0.011s
  Chunks created: 50
  Avg chunk processing time: 0.2ms
  Characters per chunk: 866
.
Chunk Size 2000 (overlap 400) Results:
  Processing time: 0.011s
  Chunks created: 49
  Avg chunk processing time: 0.2ms
  Characters per chunk: 883
.
Memory Usage Benchmark Results:
  Baseline memory: 103.3 MB
  Max memory increase: 0.3 MB
  Average memory increase: -0.1 MB
  Memory per chunk: 0.01 MB
  Document size: 411.6 KB
  Processing time: 0.095s
.
Scalability Benchmark Results:
  Sections: 10
    Document size: 10739 chars
    Processing time: 0.008s
    Chunks created: 2
    Throughput: 1334625 chars/second
  Sections: 50
    Document size: 53571 chars
    Processing time: 0.022s
    Chunks created: 6
    Throughput: 2413135 chars/second
  Sections: 100
    Document size: 107117 chars
    Processing time: 0.030s
    Chunks created: 12
    Throughput: 3612106 chars/second
  Sections: 200
    Document size: 214857 chars
    Processing time: 0.048s
    Chunks created: 25
    Throughput: 4503993 chars/second
.
Concurrent Processing Scalability Results:
  Workers: 1
    Processing time: 0.061s
    Efficiency: 328.083 files/second/worker
  Workers: 2
    Processing time: 0.062s
    Efficiency: 161.709 files/second/worker
  Workers: 4
    Processing time: 0.062s
    Efficiency: 81.125 files/second/worker
  Workers: 8
    Processing time: 0.066s
    Efficiency: 37.839 files/second/worker
.
Chunking Method Performance Comparison:
  Structure Method:
    Average time: 0.009s ± 0.000s
    Average chunks: 60.0
    Throughput: 6645.0 chunks/second
  Fixed Method:
    Average time: 0.009s ± 0.000s
    Average chunks: 48.0
    Throughput: 5469.3 chunks/second
.
Memory Leak Detection Results:
  Baseline memory: 103.7 MB
  Memory after 20 iterations: 0.0 MB increase
  Average memory increase: 0.0 MB
  Max memory increase: 0.0 MB
.
Large File Memory Efficiency Results:
  File size: 0.6 MB
  Memory increase: 2.8 MB
  Memory ratio: 4.70x file size
  Chunks created: 34
.
tests/unit/chromadb/test_client.py .F

=================================== FAILURES ===================================
___________________ TestChromaDBClient.test_connect_success ____________________
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/unittest/mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/pkgutil.py:513: in resolve_name
    mod = importlib.import_module(modname)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
../../../.local/share/uv/python/cpython-3.12.10-macos-aarch64-none/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   ModuleNotFoundError: No module named 'chromadb'
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /Users/husam/workspace/tools/shard-markdown/.venv/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests/e2e/test_cli_workflows.py: 2352 warnings
tests/integration/test_document_processing.py: 63 warnings
tests/performance/test_benchmarks.py: 869 warnings
  /Users/husam/workspace/tools/shard-markdown/src/shard_markdown/core/metadata.py:166: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    enhanced["processed_at"] = datetime.utcnow().isoformat()

tests/e2e/test_cli_workflows.py: 80 warnings
tests/integration/test_document_processing.py: 27 warnings
tests/performance/test_benchmarks.py: 152 warnings
  /Users/husam/workspace/tools/shard-markdown/.venv/lib/python3.12/site-packages/pydantic/main.py:212: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)

tests/e2e/test_cli_workflows.py: 7 warnings
tests/integration/test_document_processing.py: 3 warnings
tests/performance/test_benchmarks.py: 1 warning
  /Users/husam/workspace/tools/shard-markdown/src/shard_markdown/utils/errors.py:33: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self.timestamp = datetime.utcnow()

tests/e2e/test_cli_workflows.py::TestBasicCLIWorkflows::test_config_management_workflow
  /Users/husam/workspace/tools/shard-markdown/.venv/lib/python3.12/site-packages/pydantic/main.py:1114: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn('The `dict` method is deprecated; use `model_dump` instead.', category=PydanticDeprecatedSince20)

tests/performance/test_benchmarks.py::TestProcessingBenchmarks::test_chunking_performance_by_size[1000-200]
  /Users/husam/workspace/tools/shard-markdown/.venv/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/performance/test_benchmarks.py::TestProcessingBenchmarks::test_chunking_performance_by_size[1000-200] returned <class 'dict'>.
  Did you mean to use `assert` instead of `return`?
  See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
    warnings.warn(

tests/performance/test_benchmarks.py::TestProcessingBenchmarks::test_chunking_performance_by_size[1500-300]
  /Users/husam/workspace/tools/shard-markdown/.venv/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/performance/test_benchmarks.py::TestProcessingBenchmarks::test_chunking_performance_by_size[1500-300] returned <class 'dict'>.
  Did you mean to use `assert` instead of `return`?
  See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
    warnings.warn(

tests/performance/test_benchmarks.py::TestProcessingBenchmarks::test_chunking_performance_by_size[2000-400]
  /Users/husam/workspace/tools/shard-markdown/.venv/lib/python3.12/site-packages/_pytest/python.py:161: PytestReturnNotNoneWarning: Test functions should return None, but tests/performance/test_benchmarks.py::TestProcessingBenchmarks::test_chunking_performance_by_size[2000-400] returned <class 'dict'>.
  Did you mean to use `assert` instead of `return`?
  See https://docs.pytest.org/en/stable/how-to/assert.html#return-not-none for more information.
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
SKIPPED [1] tests/integration/test_document_processing.py:500: Skipping large file test - impractical to create 100MB+ file in tests. Size limit logic verified through code review.
SKIPPED [1] tests/performance/test_benchmarks.py:175: Chunk size 500 too small for test content - chunks exceed size limits
FAILED tests/unit/chromadb/test_client.py::TestChromaDBClient::test_connect_success
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
============ 1 failed, 52 passed, 2 skipped, 3559 warnings in 4.46s ============
